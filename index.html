<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ik Beurteilung</title>
<style>
  body {font-family: Arial, sans-serif; background:#f4f6f8; margin:20px;}
  .container {max-width:980px; background:#fff; padding:18px; border-radius:10px; box-shadow:0 1px 3px rgba(0,0,0,.08);}
  .grid {display:grid; grid-template-columns:1fr 1fr; gap:18px;}
  label {display:block; margin-top:10px; font-weight:600; font-size:13px;}
  input, select {width:100%; padding:8px; margin-top:4px; border:1px solid #d0d7de; border-radius:8px; font-size:14px;}
  .box {background:#eef3ff; padding:10px; margin-top:10px; border-radius:8px; font-weight:700;}
  .box span {font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;}
  .status-ok {color:#0a7a3c;}
  .status-bad {color:#b42318;}
  .status-warn {color:#a15c00;}
  .details {margin-top:14px; padding:12px; background:#0b1020; color:#e6edf3; border-radius:10px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; white-space: pre-wrap;}
  .muted {color:#57606a; font-size:12px; margin-top:8px; line-height:1.35;}
  @media (max-width:900px){ .grid{grid-template-columns:1fr;} }
</style>
</head>
<body>
<div class="container">
  <h2 style="margin:0 0 6px;">Kurzschlussstrom Beurteilung</h2>
  <div class="muted">
    Kupfer fix: ρ = 0.0178 Ω·mm²/m. Leitungsschleife nach Vorgabe:
    1-polig (1L) → 2·L, 3-polig (3) → √3·L.
  </div>

  <div class="grid">
    <div>
      <label for="u0">Spannung U (V)</label>
      <input type="number" id="u0" value="230" min="0" step="1" />

      <label for="ik_start">Ik am Anfang (A)</label>
      <input type="number" id="ik_start" value="1000" min="0" step="1" />

      <label for="length">Leitungslänge L (m)</label>
      <input type="number" id="length" value="20" min="0" step="0.1" />

      <label for="cross">Querschnitt Cu (mm²)</label>
      <select id="cross"></select>

      <label for="looptype">Leitungstyp (Schleifenfaktor)</label>
      <select id="looptype">
        <option value="2">1-polig (1L): Faktor 2 · L</option>
        <option value="1.7320508075688772">3-polig (3L): Faktor √3 · L</option>
      </select>

      <div class="box">
        Ik min gerechnet (Leitungsende): <span id="ik_min_calc">-</span> A
      </div>
    </div>

    <div>
      <label for="prot">Schutzorgan</label>
      <select id="prot">
        <option value="DIAZED">DIAZED</option>
        <option value="DIN">DIN gG/gL</option>
        <option value="LSB">LS B</option>
        <option value="LSC" selected>LS C</option>
        <option value="LSD">LS D</option>
      </select>

      <label for="in">Nennstrom (A)</label>
      <select id="in"></select>

      <label for="time">Auslösezeit</label>
      <select id="time">
        <option value="0.4">0.4 s</option>
        <option value="5">5 s</option>
      </select>

      <label for="factor">Faktor NIN </label>
      <select id="factor">
        <option value="1.00">1.00</option>
        <option value="0.66" selected>0.66</option>
      </select>

      <div class="box">
        Ik min erforderlich (Tabelle): <span id="ik_min_required">-</span> A
      </div>

      <div class="box">
        Beurteilung: <span id="status" class="status-warn">-</span>
      </div>

      <div class="muted">
        Die Zeit-Grenzen sind:
        ≤32A Endstromkreis und ≤63A Steckdose → 0.4 s; sonst 5 s.
      </div>
    </div>
  </div>

  <div class="details" id="details"></div>
</div>

<script>
(function(){
  const rho = 0.0178; // Ω·mm²/m (Cu), Vorgabe

  const CROSS_SECTIONS = [1, 1.5, 2.5, 4, 6, 10, 16, 25, 35, 70, 95, 100, 120, 180, 240];
  const FUSE_RATINGS   = [6, 10, 13, 16, 20, 25, 32, 40, 63, 80, 100, 125, 160, 200, 250, 315, 400, 500, 630];

  // 1:1 aus PDF (Seite 1) übernommen.  [oai_citation:2‡IK_Tabelle_ecb_de_2026.01.08.pdf](sediment://file_00000000591872469f1dbcbaa663eb73)  [oai_citation:3‡IK_Tabelle_ecb_de_2026.01.08.pdf](sediment://file_00000000591872469f1dbcbaa663eb73)
  // table[time][prot][factor][In] = Ik_min
const table = {

  "0.4": {

    "DIAZED": {
      "1.00": {6:35,10:55,13:null,16:80,20:120,25:160,32:240,40:280,50:350,63:510},
      "0.66": {6:53,10:83,13:null,16:121,20:182,25:242,32:364,40:424,50:530,63:773}
    },

    "DIN": {
      "1.00": {6:47,10:80,13:100,16:123,20:156,25:213,32:270,40:360,50:479,63:622},
      "0.66": {6:71,10:121,13:152,16:186,20:236,25:323,32:409,40:545,50:726,63:942}
    },

    "LSB": {
      "1.00": {6:30,10:50,13:65,16:80,20:100,25:125,32:160,40:200,50:250,63:315},
      "0.66": {6:45,10:76,13:98,16:121,20:152,25:189,32:242,40:303,50:379,63:477}
    },

    "LSC": {
      "1.00": {6:60,10:100,13:130,16:160,20:200,25:250,32:320,40:400,50:500,63:630},
      "0.66": {6:91,10:152,13:197,16:242,20:303,25:379,32:485,40:606,50:758,63:955}
    },

    "LSD": {
      "1.00": {6:120,10:200,13:260,16:320,20:400,25:500,32:640,40:800,50:1000,63:1260},
      "0.66": {6:182,10:303,13:394,16:485,20:606,25:758,32:970,40:1212,50:1515,63:1909}
    }
  },


  "5": {

    "DIAZED": {
      "1.00": {6:20,10:40,13:null,16:60,20:75,25:100,32:150,40:160,50:220,63:280,80:380,100:480},
      "0.66": {6:30,10:61,13:null,16:91,20:114,25:152,32:227,40:242,50:333,63:424,80:576,100:727}
    },

    "DIN": {
      "1.00": {6:30,10:47,13:60,16:70,20:85,25:118,32:156,40:200,50:260,63:350,80:452,100:573,125:750,160:995,200:1290,250:1665,315:2080,400:2720,500:3580,630:5100},
      "0.66": {6:45,10:71,13:91,16:106,20:129,25:179,32:236,40:303,50:394,63:530,80:685,100:868,125:1136,160:1508,200:1955,250:2523,315:3152,400:4121,500:5424,630:7727}
    },

    "LSB": {
      "1.00": {6:30,10:50,13:65,16:80,20:100,25:125,32:160,40:200,50:250,63:315,80:400,100:500,125:625},
      "0.66": {6:45,10:76,13:98,16:121,20:152,25:189,32:242,40:303,50:379,63:477,80:606,100:758,125:947}
    },

    "LSC": {
      "1.00": {6:60,10:80,13:90,16:100,20:150,25:170,32:220,40:250,50:300,63:500,80:500,100:600,125:820},
      "0.66": {6:91,10:121,13:136,16:152,20:227,25:258,32:333,40:379,50:455,63:758,80:758,100:909,125:1242}
    },

    "LSD": {
      "1.00": {10:100,16:110,20:150,25:170,32:220,40:250,50:300,63:500,80:520,100:650},
      "0.66": {10:152,16:167,20:227,25:258,32:333,40:379,50:455,63:758,80:758,100:985}
    }

  }
};

  const $ = (id) => document.getElementById(id);

  function fillSelect(id, values, formatter){
    const sel = $(id);
    sel.innerHTML = "";
    values.forEach(v => {
      const opt = document.createElement("option");
      opt.value = String(v);
      opt.textContent = formatter ? formatter(v) : String(v);
      sel.appendChild(opt);
    });
  }

  function getRequiredIk(){
    const time   = $("time").value;
    const prot   = $("prot").value;
    const factor = $("factor").value;
    const In     = parseInt($("in").value, 10);

    const t = table[time];
    if(!t || !t[prot] || !t[prot][factor]) return null;

    const val = t[prot][factor][In];
    return (typeof val === "number" && isFinite(val)) ? val : null;
  }

  function calcIkEnd(){
    const U0  = parseFloat($("u0").value);
    const Ik0 = parseFloat($("ik_start").value);
    const L   = parseFloat($("length").value);
    const A   = parseFloat($("cross").value);
    const kL  = parseFloat($("looptype").value); // 2 oder √3

    if(!(U0 > 0) || !(Ik0 > 0) || !(L >= 0) || !(A > 0)) {
      return {IkEnd: null, Z0: null, Rline: null, Ztot: null, U0: U0};
    }

    const Z0 = U0 / Ik0;
    const Rline = (rho * (kL * L)) / A;
    const Ztot = Z0 + Rline;
    const IkEnd = (Ztot > 0) ? (U0 / Ztot) : null;

    return {IkEnd, Z0, Rline, Ztot, U0};
  }

  function recalc(){
    const IkReq = getRequiredIk();
    $("ik_min_required").textContent = (IkReq !== null) ? String(IkReq) : "-";

    const {IkEnd, Z0, Rline, Ztot, U0} = calcIkEnd();
    const IkEndRounded = (IkEnd !== null) ? Math.round(IkEnd) : null;
    $("ik_min_calc").textContent = (IkEndRounded !== null) ? String(IkEndRounded) : "-";

    const st = $("status");
    if(IkReq === null){
      st.textContent = "kein Tabellenwert";
      st.className = "status-warn";
    } else if(IkEndRounded === null){
      st.textContent = "Eingaben unvollständig";
      st.className = "status-warn";
    } else if(IkEndRounded >= IkReq){
      st.textContent = "OK";
      st.className = "status-ok";
    } else {
      st.textContent = "NICHT OK";
      st.className = "status-bad";
    }

    const lines = [];
    lines.push(`U0            = ${isFinite(U0) ? U0.toFixed(0) : "-"} V`);
    lines.push(`ρ(Cu)         = ${rho} Ω·mm²/m`);
    lines.push("");
    lines.push(`Ik Anfang      = ${$("ik_start").value || "-"} A`);
    lines.push(`L              = ${$("length").value || "-"} m`);
    lines.push(`A              = ${$("cross").value || "-"} mm²`);
    lines.push(`Schleifenfaktor= ${$("looptype").value}`);
    lines.push("");
    lines.push(`Z Anfang       = ${Z0 !== null ? Z0.toFixed(4) : "-"} Ω`);
    lines.push(`R Leitung      = ${Rline !== null ? Rline.toFixed(4) : "-"} Ω`);
    lines.push(`Z gesamt       = ${Ztot !== null ? Ztot.toFixed(4) : "-"} Ω`);
    lines.push("");
    lines.push(`Ik Ende (calc) = ${IkEndRounded !== null ? IkEndRounded : "-"} A`);
    lines.push(`Ik min (tab)   = ${IkReq !== null ? IkReq : "-"} A`);
    $("details").textContent = lines.join("\n");
  }

  // Init
  fillSelect("cross", CROSS_SECTIONS, v => String(v).replace(".", ","));
  fillSelect("in", FUSE_RATINGS, v => String(v));

  $("cross").value = "2.5";
  $("in").value = "16";

  ["u0","ik_start","length","cross","looptype","prot","in","time","factor"].forEach(id=>{
    const e = $(id);
    e.addEventListener("input", recalc);
    e.addEventListener("change", recalc);
  });

  recalc();
})();
</script>
</body>
</html>
